message ServerIdentity {
    optional bytes public = 1;
    optional bytes id = 2;
    required string address = 3;
    optional string description = 4;
}

message Roster {
    optional bytes id = 1;
    repeated ServerIdentity list = 2;
    optional bytes aggregate = 3;
}

message Election {
    required string id = 1;
    required string admin = 2;
    required string start = 3;
    required string end = 4;
    required bytes data = 5;
    required Roster roster = 6;
    
    repeated string users = 7;

    optional bytes key = 8;
    optional string description = 9;
}

message Ballot {
    required string user = 1;

    // ElGamal key pair
    required bytes alpha = 2;
    required bytes beta = 3;
}

message Authenticate {
    required string code = 1;
}

message AuthenticateResponse {
    required string token = 1;
    
    enum Level {
        ADMIN = 0;
        USER = 1;
    }
    required Level level = 2;
}

message GenerateElection {
    required string token = 1;
    required Election election = 2;
}

message GenerateElectionResponse {
    required bytes key = 1;
}

message GetElections {
    required string token = 1;
    required string user = 2;
}

message GetElectionResponse {
    repeated Election elections = 1;
}

message CastBallot {
    required string token = 1;
    required string id = 2;
    required Ballot ballot = 3;
}

message CastBallotResponse {
    required uint32 block = 1;
}

message GetBallot {
    required string token = 1;
    required string id = 2;
    required string user = 3;
}

message GetBallotResponse {
    required Ballot ballot = 1;
}

message Shuffle {
    required string token = 1;
    required string id = 2;
}

message ShuffleResponse {
    required uint32 block = 1;
}

message GetShuffle {
    required string token = 1;
    required string id = 2;
    required uint32 block = 3;
}

message GetShuffleResponse {
    repeated Ballot ballots = 1;
}
